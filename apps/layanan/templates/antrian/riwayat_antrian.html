{% load static %}
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Riwayat Panggilan Antrian</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-5">
  <h2 class="mb-4 text-center">Riwayat Panggilan Antrian</h2>

  <!-- Form Dropdown -->
  <form method="get" class="mb-4">
    <label for="session_id" class="form-label">Pilih Kegiatan / Sesi Antrian:</label>
    <select name="session_id" id="session_id" class="form-select" onchange="this.form.submit()">
      <option value="">-- Pilih Sesi --</option>
      {% for s in sessions %}
        <option value="{{ s.id }}" {% if s == selected_session %}selected{% endif %}>
          {{ s.tanggal }} - {{ s.kegiatan }}
        </option>
      {% endfor %}
    </select>
  </form>

  {% if selected_session %}
    <div class="alert alert-info fw-bold">
      Menampilkan riwayat untuk kegiatan: <span class="text-primary">{{ selected_session.kegiatan }}</span> ({{ selected_session.tanggal }})
    </div>

    {% if antrian_dilayani %}
      <table class="table table-bordered table-striped">
        <thead>
          <tr>
            <th>No</th>
            <th>Nama</th>
            <th>NIK</th>
            <th>RT</th>
            <th>RW</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for a in antrian_dilayani %}
            <tr>
              <td>{{ a.nomor }}</td>
              <td>{{ a.nama }}</td>
              <td>{{ a.nik }}</td>
              <td>{{ a.rt }}</td>
              <td>{{ a.rw }}</td>
              <td class="text-success">{{ a.status|title }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <div class="alert alert-warning">Belum ada warga yang dilayani dalam sesi ini.</div>
    {% endif %}
  {% endif %}
</div>

</body>
</html>
